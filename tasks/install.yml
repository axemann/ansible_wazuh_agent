---
- name: "RedHat | Install wazuh-agent"
  ansible.builtin.include_tasks: setup-RedHat.yml
  when: ansible_os_family == "RedHat" or ansible_os_family == "Rocky"

- name: "Debian | Install wazuh-agent"
  ansible.builtin.include_tasks: setup-Debian.yml
  when: ansible_os_family == "Debian"

- name: "Windows | Install wazuh-agent"
  include_tasks: setup-Windows.yml
  when: ansible_os_family == "Windows"

- name: "Start wazuh-agent"
  ansible.builtin.service:
    name: wazuh-agent
    state: started
    enabled: true
  when:
    - ansible_os_family != "Windows"
    - not wazuh_agent_dl_only|bool
